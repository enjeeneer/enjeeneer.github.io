<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Scott Jeen">
<meta name="description" content="Scott Jeen\(^{1}\), Tom Bewley\(^{2}\), &amp;amp; Jonathan M. Cullen\(^{1}\) \(^{1}\) University of Cambridge
\(^{2}\) University of Bristol
[Paper] [View Code on GitHub]
 Summary Imagine you&amp;rsquo;ve collected a dataset from a system you&amp;rsquo;d like to control more efficiently. Examples include: household robots, chemical manufacturing processes, autonomous vehicles, or steel-making furnaces. An ideal solution would be to train an autonomous agent on your dataset, then for it to use what it learns to solve any task inside the system." />
<meta name="keywords" content="Scott Jeen" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="#6B8E23" />
<link rel="canonical" href="https://enjeeneer.io/projects/conservative-world-models/" />


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-192648932-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


    <title>
        
            Conservative World Models :: Scott Jeen  — AI researcher
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://enjeeneer.io/main.cbec4bded5981a9639be0a9253dbc5636fb308fba08c31a50670aee0a034a132.css">




    <link rel="apple-touch-icon" sizes="180x180" href="https://enjeeneer.io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://enjeeneer.io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://enjeeneer.io/favicon-16x16.png">
    <link rel="manifest" href="https://enjeeneer.io/site.webmanifest">
    <link rel="mask-icon" href="https://enjeeneer.io/safari-pinned-tab.svg" color="#6B8E23">
    <link rel="shortcut icon" href="https://enjeeneer.io/favicon.ico">
    <meta name="msapplication-TileColor" content="#6B8E23">
    <meta name="theme-color" content="#6B8E23">



<meta itemprop="name" content="Conservative World Models">
<meta itemprop="description" content="Scott Jeen\(^{1}\), Tom Bewley\(^{2}\), &amp; Jonathan M. Cullen\(^{1}\) \(^{1}\) University of Cambridge
\(^{2}\) University of Bristol
[Paper] [View Code on GitHub]
 Summary Imagine you&rsquo;ve collected a dataset from a system you&rsquo;d like to control more efficiently. Examples include: household robots, chemical manufacturing processes, autonomous vehicles, or steel-making furnaces. An ideal solution would be to train an autonomous agent on your dataset, then for it to use what it learns to solve any task inside the system."><meta itemprop="datePublished" content="2023-09-26T17:27:21+01:00" />
<meta itemprop="dateModified" content="2023-09-26T17:27:21+01:00" />
<meta itemprop="wordCount" content="1032"><meta itemprop="image" content="https://enjeeneer.io"/>
<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://enjeeneer.io"/>

<meta name="twitter:title" content="Conservative World Models"/>
<meta name="twitter:description" content="Scott Jeen\(^{1}\), Tom Bewley\(^{2}\), &amp; Jonathan M. Cullen\(^{1}\) \(^{1}\) University of Cambridge
\(^{2}\) University of Bristol
[Paper] [View Code on GitHub]
 Summary Imagine you&rsquo;ve collected a dataset from a system you&rsquo;d like to control more efficiently. Examples include: household robots, chemical manufacturing processes, autonomous vehicles, or steel-making furnaces. An ideal solution would be to train an autonomous agent on your dataset, then for it to use what it learns to solve any task inside the system."/>



    <meta property="og:title" content="Conservative World Models" />
<meta property="og:description" content="Scott Jeen\(^{1}\), Tom Bewley\(^{2}\), &amp; Jonathan M. Cullen\(^{1}\) \(^{1}\) University of Cambridge
\(^{2}\) University of Bristol
[Paper] [View Code on GitHub]
 Summary Imagine you&rsquo;ve collected a dataset from a system you&rsquo;d like to control more efficiently. Examples include: household robots, chemical manufacturing processes, autonomous vehicles, or steel-making furnaces. An ideal solution would be to train an autonomous agent on your dataset, then for it to use what it learns to solve any task inside the system." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://enjeeneer.io/projects/conservative-world-models/" /><meta property="og:image" content="https://enjeeneer.io"/><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2023-09-26T17:27:21+01:00" />
<meta property="article:modified_time" content="2023-09-26T17:27:21+01:00" />







    <meta property="article:published_time" content="2023-09-26 17:27:21 &#43;0100 &#43;0100" />








<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>

    
    </head>

    <body class="">
        <div class="container">
            <header class="header">
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-192648932-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
    <span class="header__inner">
        <a href="https://enjeeneer.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">/enjeeneer/</span>
            <span class="logo__cursor" style=
                  "
                   background-color:#6B8E23;
                   animation-duration:1s;">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://enjeeneer.io/about/">about</a></li><li><a href="https://enjeeneer.io/cv/cv-sep23-coffee.pdf">cv</a></li><li><a href="https://enjeeneer.io/posts/">posts</a></li><li><a href="https://enjeeneer.io/projects/">projects</a></li><li><a href="https://scholar.google.com/citations?user=3HPX720AAAAJ&amp;hl=en&amp;oi=ao">scholar</a></li><li><a href="https://enjeeneer.io/talks/">talks</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://enjeeneer.io/projects/conservative-world-models/">Conservative World Models</a></h2>
            <h3 class="loc"><a href="https://enjeeneer.io/projects/conservative-world-models/"></a></h3>
            <h3 class="time"><a href="https://enjeeneer.io/projects/conservative-world-models/"></a></h3>

            

            

            <div class="post-content">
                <h3 id="scott-jeen1-tom-bewley2--jonathan-m-cullen1">Scott Jeen\(^{1}\), Tom Bewley\(^{2}\), &amp; Jonathan M. Cullen\(^{1}\)</h3>
<p>\(^{1}\) <em>University of Cambridge</em></p>
<p>\(^{2}\) <em>University of Bristol</em></p>
<p><strong><a href="https://arxiv.org/abs/2309.15178">[Paper]</a></strong> <strong><a href="https://github.com/enjeeneer/conservative-world-models">[View Code on GitHub]</a></strong></p>
<hr>
<h3 id="summary">Summary</h3>
<p>Imagine you&rsquo;ve collected a dataset from a system you&rsquo;d like to control more efficiently. Examples include: household robots, chemical manufacturing processes, autonomous vehicles,
or steel-making furnaces. An ideal solution would be to train an autonomous agent on your dataset, then for it to use what it learns to solve <em>any</em> task inside the system. For our household robot, such
tasks may include sweeping the floor, making a cup of tea, or cleaning the windows. Formally, we call this problem setting <em>zero-shot reinforcement learning (RL)</em>, and taking steps toward realising it in the real-world is the focus of this work.</p>
<p>If our dataset is pseudo-optimal, that is to say, it tells our domestic robot the full extent of the floorspace, where the tea bags are stored, and how many windows exist,
then the existing state-of-the-art method, Forward Backward (FB) representations, performs excellently. On average it will
solve any task you want inside the system with 85% accuracy. However, if the data we&rsquo;ve collected from the system is <em>suboptimal</em>&ndash;it doesn&rsquo;t provide all the information required to solve all tasks&ndash;then
FB representations fail. They fail because they overestimate the value of the data not present in the dataset, or in RL parlance, they
<em>overestimate out-of-distribution state-action values</em>&ndash;Figure 1 (Middle).</p>
<p>In this work, we resolve this by artificially suppressing these out-of-distribution values, leveraging ideas from <em>conservatism</em> in the Offline RL literature.
The family of algorithms we propose are called <em>Conservative</em> Forward Backward representations&ndash;Figure 1 (Right). In experiments across
a variety of systems and tasks, we show these methods consistently outperform FB representations when the datasets are suboptimal.</p>
<figure><img src="https://github.com/enjeeneer/conservative-world-models/blob/main/media/vcfb-intuition-final.png?raw=true"/>
</figure>

<p><em>Figure 1: <strong>FB&rsquo;s failure-mode on sub-optimal datasets and VC-FB&rsquo;s resolution.</strong> (Left) Ground truth value functions for two tasks in an environment for a given marginal state. (Middle) FB representations overestimate the value of actions not in the dataset for all tasks. (Right) Value-Conservative Forward Backward (VC-FB) Representations suppress the value of actions not in the  dataset for all tasks. Black dots represent state-action samples present in the dataset.</em></p>
<hr>
<h3 id="intuition">Intuition</h3>
<figure><img src="https://github.com/enjeeneer/conservative-world-models/blob/main/media/overestimates.png?raw=true"/>
</figure>

<p><em>Figure 2: <strong>FB value overestimation with respect to dataset size ((n)) and quality</strong>. Log \(Q\) values and IQM of rollout performance on all Point-mass Maze tasks for datasets (a) RND and (b) RANDOM. \(Q\) values predicted during training increase as both the size and “quality” of the dataset decrease. This contradicts the low return of all resultant policies. Informally, we say the RND dataset is “high” quality, and the RANDOM dataset is “low” quality.</em></p>
<p>When the dataset is inexhaustive, FB representations overestimate the value of actions not in the dataset. The above
shows this overestimation as dataset size and quality is varied. The smaller and less diverse the dataset, the more
$Q$ values tend to be overestimated.</p>
<p>We fix this by suppressing the predicted values for actions not in the dataset, and show how this resolves overestimation
in the below. Below wer show modified version of Point-mass Maze from the ExORL benchmark.
Episodes begin with a point-mass initialised in the upper left of the maze (⊚), and the agent is tasked with selecting
\(x\) and \(y\) tilt directions such that the mass is moved towards one of two goal locations (⊛ and ⊛). The action space is two-dimensional
and bounded in \([−1,1]\). We take the RND dataset and remove all “left” actions such that \(a_x \in [0, 1]\) and
\(a_y \in [−1, 1]\), creating a dataset that has the necessary information for solving the tasks, but is inexhaustive (below (a)).
We train FB and VC-FB on this dataset and plot the highest-reward trajectories–below (b) and (c).
FB overestimates the value of OOD actions and cannot complete either task. Conversely, VC-FB synthesises the requisite
information from the dataset and completes both tasks.</p>
<figure><img src="https://github.com/enjeeneer/conservative-world-models/blob/main/media/didactic.png?raw=true"/>
</figure>

<p><em>Figure 3: <strong>Ignoring out-of-distribution actions</strong>. The agents are tasked with learning separate policies for reaching ⊛ and ⊛. (a) RND dataset with all “left” actions removed; quivers represent the mean action direction in each state bin. (b) Best FB rollout after 1 million learning steps. (c) Best VC-FB performance after 1 million learning steps. FB overestimates the value of OOD actions and cannot complete either task; VC-FB synthesises the requisite information from the dataset and completes both tasks.</em></p>
<hr>
<h3 id="aggregate-performance-on-suboptimal-datasets">Aggregate Performance on Suboptimal Datasets</h3>
<figure><img src="https://github.com/enjeeneer/conservative-world-models/blob/main/media/performance-profiles-subplot.png?raw=true"/>
</figure>

<p><em>Figure 4: <strong>Aggregate zero-shot performance.</strong> (Left): IQM of task scores across datasets and domains, normalised against the performance of CQL, our baseline. (Right) Performance profiles showing the distribution of scores across all tasks and domains. Both conservative FB variants stochastically dominate vanilla FB. The black dashed line represents the IQM of CQL performance across all datasets, domains, tasks and seeds.</em></p>
<p>Both MC-FB and VC-FB stochastically dominate FB, achieving 150% and 137% its performance respectively.
MC-FB and VC-FB outperform our single-task baseline in expectation, reaching 111% and 120% of
CQL performance respectively <strong>despite not having access to task-specific reward labels and needing
to fit policies for all tasks</strong>. This is a surprising result, and to the best of our knowledge, the first time
a multi-task offline agent has been shown to outperform a single-task analogue.</p>
<hr>
<h3 id="aggregate-performance-on-full-datasets">Aggregate Performance on Full Datasets</h3>
<p><em>Table 1: <strong>Performance on full RND dataset.</strong> Aggregated IQM scores for all tasks with 95% confidence intervals, averaged across three seeds. Both VC-FB and MC-FB maintain the performance of FB.</em></p>
<table>
<thead>
<tr>
<th><strong>Domain</strong></th>
<th><strong>Task</strong></th>
<th><strong>FB</strong></th>
<th><strong>VC-FB</strong></th>
<th><strong>MC-FB</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Walker</td>
<td>all tasks</td>
<td>639 (616–661)</td>
<td>659 (647–670)</td>
<td>651 (632–671)</td>
</tr>
<tr>
<td>Quadruped</td>
<td>all tasks</td>
<td>656 (638–674)</td>
<td>579 (522–635)</td>
<td>635 (628–642)</td>
</tr>
<tr>
<td>Maze</td>
<td>all tasks</td>
<td>219 (86–353)</td>
<td>287 (117–457)</td>
<td>261 (159–363)</td>
</tr>
<tr>
<td>Jaco</td>
<td>all tasks</td>
<td>39 (29–50)</td>
<td>33 (24–42)</td>
<td>34 (18–51)</td>
</tr>
<tr>
<td>All</td>
<td>all tasks</td>
<td>361</td>
<td><strong>381</strong></td>
<td><strong>381</strong></td>
</tr>
</tbody>
</table>
<p>Both conservative FB variants maintain (and slightly exceed) the performance
of vanilla FB. These results suggest that performance on large, diverse datasets does not suffer
as a consequence of the design decisions made  to improve performance on our small datasets that lack diversity.
Therefore, we can safely adopt conservatism into FB without worrying about performance trade-offs.</p>
<hr>
<h3 id="paper">Paper</h3>
<figure><img src="https://github.com/enjeeneer/conservative-world-models/blob/main/media/paper.png?raw=True" width="600"/>
</figure>

<p><strong><a href="https://arxiv.org/abs/2309.15178">[View on arXiv]</a></strong></p>
<p>If you find this work informative please consider citing the paper:</p>
<pre tabindex="0"><code class="language-commandline" data-lang="commandline">@article{jeen2023,
  url = {https://arxiv.org/abs/2309.15178},
  author = {Jeen, Scott and Bewley, Tom and Cullen, Jonathan M.},  
  title = {Conservative World Models},
  publisher = {arXiv},
  year = {2023},
}
</code></pre><hr>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
  		</div>

    </main>

            </div>

            
        </div>

        




<script type="text/javascript" src="https://enjeeneer.io/bundle.min.a0f363fdf81cdc5cfacc447a79c33189eb000d090336cd04aac8ee256f423b3133b836c281944c19c75e38d0b0b449f01ce5807e37798b7ac94ac1db51983fc4.js" integrity="sha512-oPNj/fgc3Fz6zER6ecMxiesADQkDNs0EqsjuJW9COzEzuDbCgZRMGcdeONCwtEnwHOWAfjd5i3rJSsHbUZg/xA=="></script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-192648932-1', 'auto');
	
	ga('send', 'pageview');
}
</script>



    </body>
</html>
